"use strict";var HTTP=function(){var e=function(e,t,n,r){var i=this;i._method=e,i._url=t,i._params=n?n:{},i._headers=r,i.run=function(e,t){$.ajax({url:i._url,type:i._method,data:i._params,headers:i._headers}).done(function(t,n,r){e(t)}).fail(function(e,n,r){t(n,r)})}},t={},n=null;return t.get=function(r,i,s){return n=new Promise(function(t,n){var o=new e("GET",r,i,s);o.run(t,n)}),t},t.post=function(r,i,s){return n=new Promise(function(t,n){var o=new e("POST",r,i,s);o.run(t,n)}),t},t.success=function(e){return n.then(e),t},t.error=function(e){return n.catch(e),t},t}();"use strict";var EventThrower=function(){var e=function(e,t){this.name=e,this.callback=t},t={};this.on=function(n,r){return n in t||(t[n]=[]),t[n].push(new e(n,r)),this},this.off=function(e){return delete t[e],this},this.trigger=function(e,n){if(e in t)for(var r=0;r<t[e].length;r++){var i=t[e][r];i.callback&&i.callback.apply(n)}return this}};"use strict";var _ev_mode=!1;EventThrower&&(_ev_mode=!0);var ModalWindow=function(){_ev_mode&&EventThrower.call(this),this.init=function(e){this._container=document.getElementById(e),this._container.style.display="none",this._return_value=null,_ev_mode&&this.trigger("init",[{target:this._container}])},this.show=function(){if(this.backdrop){var e=document.getElementById("modal-backdrop");if(!e){var t=document.getElementsByTagName("body")[0];e=document.createElement("div"),e.setAttribute("id","modal-backdrop"),e.style.zIndex="10",e.style.backgroundColor="rgba(25, 25, 25, 0.4)",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.position="absolute";if(this.backdrop==="clickable"){var n=this;e.onclick=function(e){e.preventDefault(),n.hide()}}t.appendChild(e)}else e.style.display="block"}this._container&&(this.width?this._container.style.width=this.width:this._container.style.width="60%",this.height?this._container.style.height=this.height:this._container.style.height="40%",this._container.style.position="absolute",this._container.style.display="block",this._container.style.zIndex="100",this._container.style.margin="0 auto",this._container.style.overflow="hidden",this._container.style.left="0",this._container.style.right="0",_ev_mode&&this.trigger("shown",[{target:this._container}]))},this.hide=function(){if(this.backdrop){var e=document.getElementById("modal-backdrop");e&&(e.style.display="none")}this._container&&(this._container.style.display="none",_ev_mode&&this.trigger("hidden",[{target:this._container,value:this._return_value}]))},this.setValue=function(e){this._return_value=e},this.getValue=function(){return this._return_value}};ModalWindow.prototype=Object.create(EventThrower.prototype),ModalWindow.prototype.constructor=ModalWindow;var Modal=function(){var e={};return _ev_mode&&(e=Object.create(EventThrower)),e.init=function(e,t){var n=new ModalWindow;n.init(e);for(var r in t)r in n||(n[r]=t[r]);return n},e}();"use strict";var Uploady=function(e){var t=function(e,t,n){this.id=e,this.file=t,this.fileField=n,this.fileName=function(){return this.file.name}};typeof e!="object"&&(e={}),this.onProgress=e.onProgress,this.onSuccess=e.onSuccess,this.onError=e.onError,this.onStarted=e.onStarted,this.onFinished=e.onFinished,this.fileField=e.fileField?e.fileField:"upfile",this.appendData=e.appendData?e.appendData:{},this.requestHeaders=e.requestHeaders?e.requestHeaders:{},this.targetUrl=e.targetUrl,this.singleRequest=e.singleRequest?e.singleRequest:!1;var n=[],r=0;this.addFile=function(e,i,s){var o=new t(r,e);s&&(o.fileField=s);for(var u in i)o[u]=i[u];return n.push(o),r++,o},this.addFiles=function(e,t){for(var n in e)this.addFile(e[n],t,n)},this.removeFile=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return n.splice(t,1);return null},this.finish=function(e,t,n){this.onFinished&&this.onFinished({total:n,succeed:e,failed:t})},this.setSingleRequest=function(e){this.singleRequest=e};var i=function(){var e=this,t=new XMLHttpRequest,r=new FormData;this.onStarted&&this.onStarted(null,t),t.upload.items=[];for(var i in this.requestHeaders)t.setRequestHeader(i,this.requestHeaders[i]);for(var s=0;s<n.length;s++)t.upload.items.push(n[s]),r.append(n[s].fileField?n[s].fileField:e.fileField+s,n[s].file);for(var i in this.appendData)r.append(i,this.appendData[i]);t.upload.addEventListener("progress",function(t){t.lengthComputable?e.onProgress&&e.onProgress(null,t.loaded,t.total):e.onProgress&&e.onProgress(null)}),t.addEventListener("readystatechange",function(t){this.readyState===4&&(this.status!==200?(this.abort(),e.onError&&e.onError({status:this.status,file:null})):e.onSuccess&&e.onSuccess({response:this.responseText,file:null}),e.finish())}),t.upload.addEventListener("error",function(t){e.onError&&e.onError({status:t.target.status,file:null}),e.finish()}),t.open("post",e.targetUrl,!0),t.send(r)},s=function(){var e=0,t=0,r=0,i=this;for(var s=0;s<n.length;s++){var o=n[s],u=new XMLHttpRequest;this.onStarted&&this.onStarted(o,u),u.upload.item=o;for(var a in this.requestHeaders)u.setRequestHeader(a,this.requestHeaders[a]);var f=new FormData;f.append(this.fileField,o.file);for(var a in this.appendData)f.append(a,this.appendData[a]);u.upload.addEventListener("progress",function(e){e.lengthComputable?i.onProgress&&i.onProgress(this.item,e.loaded,e.total):i.onProgress&&i.onProgress(this.item)}),u.addEventListener("readystatechange",function(s){this.readyState===4&&(this.status!==200?(this.abort(),t++,i.onError&&i.onError({status:this.status,file:this.upload.item.file})):(e++,i.onSuccess&&i.onSuccess({file:this.upload.item.file,response:this.responseText})),r++,r==n.length&&i.finish())}),u.upload.addEventListener("error",function(e){t++,r++,i.onError&&i.onError({status:e.target.status,file:this.item.file}),r==n.length&&i.finish()}),u.open("post",i.targetUrl,!0),u.send(f)}};this.upload=function(){this.singleRequest?i():s()},this.clear=function(){n=[]}};